<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat application</title>

</head>
<body>

  <div class="container">
    <h1>Chat application</h1>
    <h3>users list</h3>

   
    <div id="chat"></div>
    <div id="list"></div>

    <form id="mess-form" >
    <textarea id="chatinp" placeholder="Enter..." rows="2"></textarea>
    <button id="send">send</button>
    </form>
  </div>
<script src="/socket.io/socket.io.js" ></script> it automaticlly servers when socket is running on backened
<script> 
    const socket=io();// it creates connection to websocket server
    const chat =document.getElementById("chat");
    const list=document.getElementById("list");
    const form=document.getElementById("mess-form");
    const inp=document.getElementById("chatinp");
    const username=prompt("Enter your name")
    socket.emit("join",username)
    socket.on("userjoined",(user)=>{
      addmess(` ${user} has joined the chat `)
    })
    socket.on("list",(user)=>{
      list.innerHTML=user.map(user=>`<li>${user}</li>`).join("")
    })
    function addmess(input){
      const divblock=document.createElement("div")
      divblock.innerHTML=input
      chat.appendChild(divblock)

      //scroll bottom
      chat.scrollTop=chat.scrollHeight// automatically scroll to latest message
    }
    form.addEventListener("submit",(e)=>{
      e.preventDefault()
      const inptxt=inp.value.trim()
      if(inptxt){
        
        socket.emit("chatmess",{username:username,text:inptxt})

      }})
            //listen for chatmessage 
            socket.on("chatmess",(message)=>{
        console.log(message.username,message.text)
        addmess(`${message.username}:${message.text}`)

      })
  //disconnect
  socket.on("userleft",(username)=>{
          addmess(`${username} is left`)
        })

</script>
</body>
</html>

